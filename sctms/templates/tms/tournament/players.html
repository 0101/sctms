{% extends 'tms/tournament/index.html' %}

{% load i18n cache %}

{% block title %}{{ tournament.name }} > {% trans "Players" %} {% endblock %}

{% block box-content %}
{% cache 9000000 players tournament.id %}
<table>
    <thead>
        <tr>
            <th>{% trans "Rank" %}</th>
            <th>{% trans "Player" %}</th>
            <th>{% trans "Points" %}</th>
            <th>{% trans "Buch." %}</th>
            <th>{% trans "Wins" %}</th>
            <th>{% trans "Won against" %}</th>
            <th>{% trans "Losses" %}</th>
            <th>{% trans "Lost against" %}</th>
            <th>{% trans "Score" %}</th>
        </tr>
    </thead>

    <tbody>
    {% for i in tournament.ranking %}
        <tr class="user-{{ i.player.user.username }}">
            <td class="rank">{{ i.rank }}</td>
            <td><a class="lightbox" href="{% url tms:player_profile i.player.user.username %}">{{ i.player.user }}</a>&nbsp;({{ i.player }})</td>
            <td class="points">{{ i.points }}</td>
            <td class="buchholz">{{ i.buchholz }}</td>
            <td>{{ i.wins }}&nbsp;({{ i.win_percent }}&nbsp;%)</td>
            <td class="oponent-list">{% for player in i.won_against %}{{ player.user }}{% if not forloop.last %}, {% endif %}{% endfor %}</td>
            <td>{{ i.losses }}&nbsp;({{ i.loss_percent }}&nbsp%)</td>
            <td class="oponent-list">{% for player in i.lost_against %}{{ player.user }}{% if not forloop.last %}, {% endif %}{% endfor %}</td>
            <td>{{ i.games_won }}-{{ i.games_lost }}&nbsp;({% if i.games_won > i.games_lost %}+{% endif %}{{ i.score }})</td>
        </tr>
    {% endfor %}
    </tbody>

</table>
{% endcache %}
{% endblock %}

{% block js %}
{{ block.super }}
{% if user.is_authenticated %}
<script type="text/javascript">
$('table').find('tr.user-{{ user.username }}').addClass('me');
</script>
{% endif %}
{% endblock %}
